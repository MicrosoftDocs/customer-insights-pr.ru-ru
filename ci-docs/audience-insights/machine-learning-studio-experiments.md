---
title: Эксперименты со студией машинного обучения (классическая версия)
description: Используйте модели студии машинного обучения (классическая версия) в Dynamics 365 Customer Insights.
ms.date: 12/03/2020
ms.service: customer-insights
ms.subservice: audience-insights
ms.topic: conceptual
author: m-hartmann
ms.author: mhart
ms.reviewer: ameetj
manager: shellyha
ms.openlocfilehash: 556b6810db0ed2733a3f086291757bd85b77e371
ms.sourcegitcommit: a9b2cf598f256d07a48bba8617347ee90024a1dd
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/03/2020
ms.locfileid: "4669034"
---
# <a name="use-models-based-on-azure-machine-learning-studio-classic"></a><span data-ttu-id="e52d8-103">Используйте модели на основе студии машинного обучения Azure (классическая версия)</span><span class="sxs-lookup"><span data-stu-id="e52d8-103">Use models based on Azure Machine Learning Studio (classic)</span></span>

<span data-ttu-id="e52d8-104">Единые данные в Dynamics 365 Customer Insights являются источником для построения моделей машинного обучения, которые могут дать дополнительную бизнес-аналитику.</span><span class="sxs-lookup"><span data-stu-id="e52d8-104">The unified data in Dynamics 365 Customer Insights is a source for building machine learning models that can generate additional business insights.</span></span> <span data-ttu-id="e52d8-105">Customer Insights интегрируется со студией машинного обучения (классической) для использования ваших собственных настраиваемых моделей.</span><span class="sxs-lookup"><span data-stu-id="e52d8-105">Customer Insights integrates with Machine Learning Studio (classic) to use your own custom models.</span></span> <span data-ttu-id="e52d8-106">Чтобы узнать, как модели, разработанные в машинном обучении Azure, интегрируются с Customer Insights, см. [Эксперименты с машинным обучением Azure](azure-machine-learning-experiments.md).</span><span class="sxs-lookup"><span data-stu-id="e52d8-106">To see how models developed in Azure Machine Learning are integrated with Customer Insights, see [Azure Machine Learning experiments](azure-machine-learning-experiments.md).</span></span>

## <a name="prerequisites"></a><span data-ttu-id="e52d8-107">Предварительные условия</span><span class="sxs-lookup"><span data-stu-id="e52d8-107">Prerequisites</span></span>

- <span data-ttu-id="e52d8-108">Доступ к Customer Insights</span><span class="sxs-lookup"><span data-stu-id="e52d8-108">Access to Customer Insights</span></span>
- <span data-ttu-id="e52d8-109">Активная подписка Azure Enterprise</span><span class="sxs-lookup"><span data-stu-id="e52d8-109">Active Azure Enterprise subscription</span></span>
- [<span data-ttu-id="e52d8-110">Объединенные профили клиента</span><span class="sxs-lookup"><span data-stu-id="e52d8-110">Unified customer profiles</span></span>](data-unification.md)
- <span data-ttu-id="e52d8-111">Настройка [экспорта сущностей в хранилище BLOB-объектов Azure](export-azure-blob-storage.md)</span><span class="sxs-lookup"><span data-stu-id="e52d8-111">[Entity export to Azure Blob storage](export-azure-blob-storage.md) set up</span></span>

## <a name="set-up-machine-learning-studio-classic"></a><span data-ttu-id="e52d8-112">Настройка студии машинного обучения (классическая версия)</span><span class="sxs-lookup"><span data-stu-id="e52d8-112">Set up Machine Learning Studio Classic</span></span>

<span data-ttu-id="e52d8-113">На первом этапе нам нужно создать рабочую область и открыть студию машинного обучения (классическую).</span><span class="sxs-lookup"><span data-stu-id="e52d8-113">In a first step, we need to create a workspace for and open the Machine Learning Studio (classic).</span></span>

1. <span data-ttu-id="e52d8-114">Перейдите в [https://www.portal.azure.com](https://www.portal.azure.com/) и выполните вход.</span><span class="sxs-lookup"><span data-stu-id="e52d8-114">Go to [https://www.portal.azure.com](https://www.portal.azure.com/) and sign in.</span></span>

1. <span data-ttu-id="e52d8-115">Выберите **Создать ресурс**.</span><span class="sxs-lookup"><span data-stu-id="e52d8-115">Select **Create a resource**.</span></span>

1. <span data-ttu-id="e52d8-116">Найдите пункт **Рабочая область студии машинного обучения** и выберите **Создать**.</span><span class="sxs-lookup"><span data-stu-id="e52d8-116">Search **Machine Learning Studio Workspace** and select **Create**.</span></span>

1. <span data-ttu-id="e52d8-117">Введите необходимые данные для [создания рабочей области](https://docs.microsoft.com/azure/machine-learning/studio/create-workspace).</span><span class="sxs-lookup"><span data-stu-id="e52d8-117">Enter the required details to [create the workspace](https://docs.microsoft.com/azure/machine-learning/studio/create-workspace).</span></span> <span data-ttu-id="e52d8-118">Выберите **Ценовая категория плана веб-службы** в зависимости от объема данных, которые вы планируете импортировать.</span><span class="sxs-lookup"><span data-stu-id="e52d8-118">Choose the **Web service plan pricing tier** based on the amount of data you plan to import.</span></span> <span data-ttu-id="e52d8-119">Для лучшей производительности выберите **Расположение**, которое географически ближе всего к вам.</span><span class="sxs-lookup"><span data-stu-id="e52d8-119">For best performance, select the **Location** that is geographically closest to you.</span></span>

1. <span data-ttu-id="e52d8-120">После создания ресурса появится панель мониторинга рабочей областью студии машинного обучения.</span><span class="sxs-lookup"><span data-stu-id="e52d8-120">After creating the resource, the Machine Learning Studio workspace dashboard will appear.</span></span> <span data-ttu-id="e52d8-121">Выберите **Запустить студию машинного обучения**.</span><span class="sxs-lookup"><span data-stu-id="e52d8-121">Select **Launch Machine Learning Studio**.</span></span>

   ![Пользовательский интерфейс студии машинного обучения Azure](media/azure-machine-learning-studio.png)

## <a name="work-with-azure-machine-learning-studio"></a><span data-ttu-id="e52d8-123">Работа со студией машинного обучения Azure</span><span class="sxs-lookup"><span data-stu-id="e52d8-123">Work with Azure Machine Learning Studio</span></span>

<span data-ttu-id="e52d8-124">Теперь вы можете создать новый эксперимент или импортировать существующий шаблон эксперимента из галереи образцов.</span><span class="sxs-lookup"><span data-stu-id="e52d8-124">You can now create a new experiment, or import an existing experiment template from the sample gallery.</span></span> <span data-ttu-id="e52d8-125">Есть примеры экспериментов для трех стандартных сценариев:</span><span class="sxs-lookup"><span data-stu-id="e52d8-125">There are sample experiments for three standard scenarios:</span></span>

- [<span data-ttu-id="e52d8-126">Прогноз оттока</span><span class="sxs-lookup"><span data-stu-id="e52d8-126">Churn prediction</span></span>](#churn-analysis)

- [<span data-ttu-id="e52d8-127">Ценность клиента на протяжении жизненного цикла</span><span class="sxs-lookup"><span data-stu-id="e52d8-127">Customer lifetime value</span></span>](#customer-lifetime-value-prediction)

- [<span data-ttu-id="e52d8-128">Рекомендация продуктов или оптимальное следующее действие</span><span class="sxs-lookup"><span data-stu-id="e52d8-128">Product recommendation or next best action</span></span>](#productrecommendation-or-next-best-action)

1. <span data-ttu-id="e52d8-129">Если вы создаете новый эксперимент или используете шаблон эксперимента из галереи, вам необходимо настроить свойства **Импорт данных**.</span><span class="sxs-lookup"><span data-stu-id="e52d8-129">If you create a new experiment or use an experiment template from the gallery, you need to configure the **Import Data** properties.</span></span> <span data-ttu-id="e52d8-130">Воспользуйтесь интерфейс с подсказками или напрямую предоставьте подробные сведения для доступа к хранилищу BLOB-объектов Azure, содержащему ваши данные.</span><span class="sxs-lookup"><span data-stu-id="e52d8-130">Use the guided experience or directly provide details to access the Azure Blob Storage that contains your data.</span></span>  

   ![Эксперимент студии машинного обучения Azure](media/azure-machine-learning-studio-experiment.png)

1. <span data-ttu-id="e52d8-132">Теперь вы можете создать пользовательский конвейер обработки для очистки и предварительной обработки данных, извлечения компонентов и обучения подходящей модели.</span><span class="sxs-lookup"><span data-stu-id="e52d8-132">Now you can build a custom processing pipeline to clean and preprocess the data, extract features, and train a suitable model.</span></span>

1. <span data-ttu-id="e52d8-133">Протестируйте и оптимизируйте производительность модели.</span><span class="sxs-lookup"><span data-stu-id="e52d8-133">Test and optimize the model performance.</span></span>

1. <span data-ttu-id="e52d8-134">Если вас устраивает качество модели, выберите **Настроить веб-службу** > **Прогнозная веб-служба**.</span><span class="sxs-lookup"><span data-stu-id="e52d8-134">When you’re satisfied with the quality of a model, select **Set up web service** > **Predictive Web Service**.</span></span> <span data-ttu-id="e52d8-135">Эта опция импортирует обученную модель и конвейер характеристик из обучающего эксперимента в службу прогнозирования.</span><span class="sxs-lookup"><span data-stu-id="e52d8-135">This option imports the trained model and the featurization pipeline from the training experiment to a predictive service.</span></span> <span data-ttu-id="e52d8-136">Служба прогнозирования может принимать другой набор входных данных со схемой, используемой в обучающем эксперименте, для создания прогнозов.</span><span class="sxs-lookup"><span data-stu-id="e52d8-136">The predictive service can take another set of input data with the schema used in the training experiment to make predictions.</span></span>

   ![Настройка прогнозной веб-службы](media/predictive-webservice-control.png)

1. <span data-ttu-id="e52d8-138">После успешного эксперимента с прогнозирующей веб-службой вы можете развернуть ее для автоматического планирования.</span><span class="sxs-lookup"><span data-stu-id="e52d8-138">Once the predictive web service experiment is successful, you can deploy it for auto scheduling.</span></span> <span data-ttu-id="e52d8-139">Чтобы веб-служба работала с Customer Insights, выберите **Развернуть веб-службу** > **Развернуть предварительную версию веб-службы [Новое]**.</span><span class="sxs-lookup"><span data-stu-id="e52d8-139">To have the web service work with Customer Insights, select **Deploy Web Service** > **Deploy Web Service [New] Preview**.</span></span> <span data-ttu-id="e52d8-140">[Дополнительные сведения о развертывании веб-службы](https://docs.microsoft.com/azure/machine-learning/studio/deploy-a-machine-learning-web-service).</span><span class="sxs-lookup"><span data-stu-id="e52d8-140">[Learn more about deploying a web service](https://docs.microsoft.com/azure/machine-learning/studio/deploy-a-machine-learning-web-service).</span></span>

   ![Развертывание прогнозной веб-службы](media/predictive-webservice-deploy.png)

## <a name="sample-models-from-the-gallery"></a><span data-ttu-id="e52d8-142">Образцы моделей из галереи</span><span class="sxs-lookup"><span data-stu-id="e52d8-142">Sample models from the gallery</span></span>

<span data-ttu-id="e52d8-143">Мы будем использовать вымышленный сценарий компании Contoso Hotel для моделей в этой статье.</span><span class="sxs-lookup"><span data-stu-id="e52d8-143">We'll use a fictitious scenario of Contoso Hotel for the models in this article.</span></span> <span data-ttu-id="e52d8-144">Компания Contoso Hotel собирает следующие данные:</span><span class="sxs-lookup"><span data-stu-id="e52d8-144">Contoso Hotel gathers the following data:</span></span>

- <span data-ttu-id="e52d8-145">Данные CRM, состоящие из активности проживания в отеле.</span><span class="sxs-lookup"><span data-stu-id="e52d8-145">CRM data consisting of hotel stay activity.</span></span> <span data-ttu-id="e52d8-146">Набор данных включает информацию о сроках пребывания для каждого зарегистрированного клиента.</span><span class="sxs-lookup"><span data-stu-id="e52d8-146">The data set includes information about the dates of stay for each registered customer.</span></span> <span data-ttu-id="e52d8-147">Он также содержит информацию о бронировании, типах номеров, деталях расходов и т. д.</span><span class="sxs-lookup"><span data-stu-id="e52d8-147">It also contains information about the booking, room types, details of spend, and so on.</span></span> <span data-ttu-id="e52d8-148">Данные охватывают четыре года, с января 2014 года по январь 2018 года.</span><span class="sxs-lookup"><span data-stu-id="e52d8-148">The data spans four years, from January 2014 to January 2018.</span></span>
- <span data-ttu-id="e52d8-149">Профили клиентов гостей отеля.</span><span class="sxs-lookup"><span data-stu-id="e52d8-149">Customer profiles of hotel guests.</span></span> <span data-ttu-id="e52d8-150">Эти профили содержат информацию о каждом клиенте, включая его имя, дату рождения, почтовый адрес, пол и номер телефона.</span><span class="sxs-lookup"><span data-stu-id="e52d8-150">These profiles contain information about each customer, including their name, birthdate, postal address, gender, and phone number.</span></span>
- <span data-ttu-id="e52d8-151">Использование служб, предлагаемых отелем, таких как спа, прачечная, Wi-Fi или курьерская служба.</span><span class="sxs-lookup"><span data-stu-id="e52d8-151">Usage of services offered by the hotel, such as the spa, laundry, WiFi, or courier.</span></span> <span data-ttu-id="e52d8-152">Эта информация регистрируется для каждого зарегистрированного клиента.</span><span class="sxs-lookup"><span data-stu-id="e52d8-152">This information is logged for each registered customer.</span></span> <span data-ttu-id="e52d8-153">Как правило, использование услуг связано с проживанием.</span><span class="sxs-lookup"><span data-stu-id="e52d8-153">Typically, use of services is linked with the stay.</span></span> <span data-ttu-id="e52d8-154">В некоторых случаях клиенты могут пользоваться услугами, не останавливаясь в отеле.</span><span class="sxs-lookup"><span data-stu-id="e52d8-154">In some cases, services can be used by customers without staying in the hotel.</span></span>

## <a name="churn-analysis"></a><span data-ttu-id="e52d8-155">Анализ оттока</span><span class="sxs-lookup"><span data-stu-id="e52d8-155">Churn Analysis</span></span>

<span data-ttu-id="e52d8-156">Анализ оттока применяется к разным сферам бизнеса.</span><span class="sxs-lookup"><span data-stu-id="e52d8-156">Churn analysis applies to different business areas.</span></span> <span data-ttu-id="e52d8-157">В этом примере мы рассмотрим отток в сфере услуг, в частности, в контексте гостиничных услуг, как описано выше.</span><span class="sxs-lookup"><span data-stu-id="e52d8-157">In this example, we’re going to look at service churn, specifically in the context of hotel services as described above.</span></span> <span data-ttu-id="e52d8-158">Он представляет собой рабочий пример конвейера сквозной модели, который можно использовать в качестве отправной точки для любого другого типа модели оттока.</span><span class="sxs-lookup"><span data-stu-id="e52d8-158">It provides a working example of an end–to–end model pipeline that can be used as a starting point for any other type of churn model.</span></span>

### <a name="definition-of-churn"></a><span data-ttu-id="e52d8-159">Определение оттока</span><span class="sxs-lookup"><span data-stu-id="e52d8-159">Definition of Churn</span></span>

<span data-ttu-id="e52d8-160">Определение оттока может отличаться в зависимости от сценария.</span><span class="sxs-lookup"><span data-stu-id="e52d8-160">The definition of churn can differ based on the scenario.</span></span> <span data-ttu-id="e52d8-161">В этом примере гость, который не посещал отель в прошлом году, должен быть помечен как отток.</span><span class="sxs-lookup"><span data-stu-id="e52d8-161">In this example, a guest who hasn’t visited the hotel in the past year should be labeled as churned.</span></span>  

<span data-ttu-id="e52d8-162">Шаблон эксперимента можно импортировать из галереи.</span><span class="sxs-lookup"><span data-stu-id="e52d8-162">The experiment template can be imported from the gallery.</span></span> <span data-ttu-id="e52d8-163">Во-первых, убедитесь, что вы импортируете данные для **Действие проживания в отеле**, **Данные клиентов** и **Данные об использовании услуг** из хранилища BLOB-объектов Azure.</span><span class="sxs-lookup"><span data-stu-id="e52d8-163">First, ensure that you import the data for **Hotel Stay Activity**, **Customer data**, and **Service Usage Data** from Azure Blob storage.</span></span>

   ![Импорт данных для модели оттока](media/import-data-azure-blob-storage.png)

### <a name="featurization"></a><span data-ttu-id="e52d8-165">Конструирование признаков</span><span class="sxs-lookup"><span data-stu-id="e52d8-165">Featurization</span></span>

<span data-ttu-id="e52d8-166">Основываясь на определении оттока, мы сначала определяем необработанные характеристики, которые будут влиять на ярлык.</span><span class="sxs-lookup"><span data-stu-id="e52d8-166">Based on the definition of churn, we first identify the raw features that will influence the label.</span></span> <span data-ttu-id="e52d8-167">Затем мы преобразуем эти необработанные характеристики в числовые характеристики, которые можно использовать с моделями машинного обучения.</span><span class="sxs-lookup"><span data-stu-id="e52d8-167">Then, we process these raw features into numerical features that can be used with machine learning models.</span></span> <span data-ttu-id="e52d8-168">Интеграция данных происходит в Customer Insights, поэтому мы можем объединить эти таблицы с помощью *идентификатора пользователя*.</span><span class="sxs-lookup"><span data-stu-id="e52d8-168">Data integration happens in Customer Insights so we can join these tables by using the *Customer ID*.</span></span>

   ![Объединение импортированных данных](media/join-imported-data.png)

<span data-ttu-id="e52d8-170">Конструирование признаков для построения модели для анализа оттока может быть немного сложной задачей.</span><span class="sxs-lookup"><span data-stu-id="e52d8-170">The featurization for building the model for churn analysis can be a little tricky.</span></span> <span data-ttu-id="e52d8-171">Данные являются функцией времени, при этом ежедневно регистрируются новые действия в отеле.</span><span class="sxs-lookup"><span data-stu-id="e52d8-171">The data is a function of time with new hotel activity recorded on daily basis.</span></span> <span data-ttu-id="e52d8-172">Во время конструирования признаков мы хотим генерировать статические признаки из динамических данных.</span><span class="sxs-lookup"><span data-stu-id="e52d8-172">During featurization, we want to generate static features from the dynamic data.</span></span> <span data-ttu-id="e52d8-173">В этом случае мы генерируем несколько характеристик на основе действий отеля со скользящим окном в один год.</span><span class="sxs-lookup"><span data-stu-id="e52d8-173">In this case, we generate multiple features from hotel activity with a sliding window of one year.</span></span> <span data-ttu-id="e52d8-174">Мы также расширяем категориальные характеристики, такие как тип номера или тип бронирования, на отдельные характеристики, используя однократное кодирование.</span><span class="sxs-lookup"><span data-stu-id="e52d8-174">We also expand the categorical features like room type or booking type into separate features using one-hot encoding.</span></span>  

<span data-ttu-id="e52d8-175">Окончательный список признаков:</span><span class="sxs-lookup"><span data-stu-id="e52d8-175">Final list of features:</span></span>

| <span data-ttu-id="e52d8-176">**Номер**</span><span class="sxs-lookup"><span data-stu-id="e52d8-176">**Number**</span></span>  | <span data-ttu-id="e52d8-177">**Original_Column**</span><span class="sxs-lookup"><span data-stu-id="e52d8-177">**Original_Column**</span></span>          | <span data-ttu-id="e52d8-178">**Производные признаки**</span><span class="sxs-lookup"><span data-stu-id="e52d8-178">**Derived Features**</span></span>                                                                                                                      |
|-------------|------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="e52d8-179">1</span><span class="sxs-lookup"><span data-stu-id="e52d8-179">1</span></span>           | <span data-ttu-id="e52d8-180">Тип номера</span><span class="sxs-lookup"><span data-stu-id="e52d8-180">Room Type</span></span>                    | <span data-ttu-id="e52d8-181">RoomTypeLargeCount, RoomTypeSmallCount</span><span class="sxs-lookup"><span data-stu-id="e52d8-181">RoomTypeLargeCount, RoomTypeSmallCount</span></span>                                                                                                    |
| <span data-ttu-id="e52d8-182">2</span><span class="sxs-lookup"><span data-stu-id="e52d8-182">2</span></span>           | <span data-ttu-id="e52d8-183">Тип резервирования</span><span class="sxs-lookup"><span data-stu-id="e52d8-183">Booking Type</span></span>                 | <span data-ttu-id="e52d8-184">BookingTypeOnlineCount, BookingTypePhoneCallCount</span><span class="sxs-lookup"><span data-stu-id="e52d8-184">BookingTypeOnlineCount, BookingTypePhoneCallCount</span></span>                                                                                         |
| <span data-ttu-id="e52d8-185">3</span><span class="sxs-lookup"><span data-stu-id="e52d8-185">3</span></span>           | <span data-ttu-id="e52d8-186">Категория путешествия</span><span class="sxs-lookup"><span data-stu-id="e52d8-186">Travel Category</span></span>              | <span data-ttu-id="e52d8-187">TravelCategoryBusinessCount, TravelCategoryLeisureCount</span><span class="sxs-lookup"><span data-stu-id="e52d8-187">TravelCategoryBusinessCount, TravelCategoryLeisureCount</span></span>                                                                                   |
| <span data-ttu-id="e52d8-188">4</span><span class="sxs-lookup"><span data-stu-id="e52d8-188">4</span></span>           | <span data-ttu-id="e52d8-189">Потрачено долларов</span><span class="sxs-lookup"><span data-stu-id="e52d8-189">Dollars Spent</span></span>                | <span data-ttu-id="e52d8-190">TotalDollarSpent</span><span class="sxs-lookup"><span data-stu-id="e52d8-190">TotalDollarSpent</span></span>                                                                                                                          |
| <span data-ttu-id="e52d8-191">5</span><span class="sxs-lookup"><span data-stu-id="e52d8-191">5</span></span>           | <span data-ttu-id="e52d8-192">Даты заезда и выезда</span><span class="sxs-lookup"><span data-stu-id="e52d8-192">Check-in and Checkout dates</span></span>  | <span data-ttu-id="e52d8-193">StayDayCount, StayDayCount2016, StayDayCount2015, StayDayCount2014, StayCount, StayCount2016.</span><span class="sxs-lookup"><span data-stu-id="e52d8-193">StayDayCount, StayDayCount2016, StayDayCount2015, StayDayCount2014, StayCount, StayCount2016.</span></span> <span data-ttu-id="e52d8-194">StayCount2015, StayCount2014</span><span class="sxs-lookup"><span data-stu-id="e52d8-194">StayCount2015, StayCount2014</span></span>                |
| <span data-ttu-id="e52d8-195">6</span><span class="sxs-lookup"><span data-stu-id="e52d8-195">6</span></span>           | <span data-ttu-id="e52d8-196">Использование услуг</span><span class="sxs-lookup"><span data-stu-id="e52d8-196">Service Usage</span></span>                | <span data-ttu-id="e52d8-197">UsageTenure, ConciergeUsage, CourierUsage, DryCleaningUsage, GymUsage, PhoneUsage, RestaurantUsage, SpaUsage, TelevisionUsage, WifiUsage</span><span class="sxs-lookup"><span data-stu-id="e52d8-197">UsageTenure, ConciergeUsage, CourierUsage, DryCleaningUsage, GymUsage, PhoneUsage, RestaurantUsage, SpaUsage, TelevisionUsage, WifiUsage</span></span>  |

### <a name="model-selection"></a><span data-ttu-id="e52d8-198">Выбор модели</span><span class="sxs-lookup"><span data-stu-id="e52d8-198">Model selection</span></span>

<span data-ttu-id="e52d8-199">Теперь нам нужно выбрать оптимальный алгоритм для использования.</span><span class="sxs-lookup"><span data-stu-id="e52d8-199">Now we need to choose the optimal algorithm to use.</span></span> <span data-ttu-id="e52d8-200">В этом случае большинство признаков основано на категориальных характеристиках.</span><span class="sxs-lookup"><span data-stu-id="e52d8-200">In this case, most features are based on categorical features.</span></span> <span data-ttu-id="e52d8-201">Обычно хорошо работают модели на основе дерева решений.</span><span class="sxs-lookup"><span data-stu-id="e52d8-201">Typically, decision tree–based models work well.</span></span> <span data-ttu-id="e52d8-202">Если есть только числовые признаки, нейронные сети могут быть лучшим выбором.</span><span class="sxs-lookup"><span data-stu-id="e52d8-202">If there are only numerical features, neural networks could be a better choice.</span></span> <span data-ttu-id="e52d8-203">Метод опорных векторов (SVM) также является хорошим кандидатом в таких ситуациях; однако для достижения максимальной производительности требуется немало настроек.</span><span class="sxs-lookup"><span data-stu-id="e52d8-203">Support vector machine (SVM) also is a good candidate in such situations; however, it needs quite a bit of tuning to extract the best performance.</span></span> <span data-ttu-id="e52d8-204">Мы выбираем **Улучшенное двухклассовое дерево принятия решений** в качестве первой модели выбора, за которой следует **Двухклассовая SVM** как вторая модель.</span><span class="sxs-lookup"><span data-stu-id="e52d8-204">We choose **Two-Class Boosted Decision Tree** as the first model of choice followed by **Two-Class SVM** as the second model.</span></span> <span data-ttu-id="e52d8-205">Студия машинного обучения Azure позволяет проводить A/B-тестирование, поэтому лучше начинать с двух моделей, а не с одной.</span><span class="sxs-lookup"><span data-stu-id="e52d8-205">Azure Machine Learning Studio lets you do A/B testing, so it’s beneficial to start with two models rather than one.</span></span>

<span data-ttu-id="e52d8-206">На следующем изображении показан конвейер обучения и оценки моделей из студии машинного обучения Azure:</span><span class="sxs-lookup"><span data-stu-id="e52d8-206">The following image shows the model training and evaluation pipeline from Azure Machine Learning Studio:</span></span>

![Модель оттока в студии машинного обучения Azure](media/azure-machine-learning-model.png)

<span data-ttu-id="e52d8-208">Мы также применяем технику под названием **Важность компонента перестановки** — важный аспект оптимизации модели.</span><span class="sxs-lookup"><span data-stu-id="e52d8-208">We also apply a technique called **Permutation Feature Importance**, an important aspect of model optimization.</span></span> <span data-ttu-id="e52d8-209">Встроенные модели практически не дают представления о влиянии какой-либо конкретной характеристики на окончательный прогноз.</span><span class="sxs-lookup"><span data-stu-id="e52d8-209">Built-in models have little to no insight into the impact of any specific feature on the final prediction.</span></span> <span data-ttu-id="e52d8-210">Калькулятор важности признаков использует специальный алгоритм для вычисления влияния отдельных признаков на результат для конкретной модели.</span><span class="sxs-lookup"><span data-stu-id="e52d8-210">The feature importance calculator uses a custom algorithm to compute the influence of individual features on the outcome for a specific model.</span></span> <span data-ttu-id="e52d8-211">Важность признака нормируется от +1 до –1.</span><span class="sxs-lookup"><span data-stu-id="e52d8-211">The feature importance is normalized between +1 to -1.</span></span> <span data-ttu-id="e52d8-212">Отрицательное влияние означает, что соответствующий признак оказывает неожиданное влияние на результат и должна быть удалена из модели.</span><span class="sxs-lookup"><span data-stu-id="e52d8-212">A negative influence means the corresponding feature has counter-intuitive influence on the outcome and should be removed from the model.</span></span> <span data-ttu-id="e52d8-213">Положительное влияние указывает на то, что этот признак вносит большой вклад в прогноз.</span><span class="sxs-lookup"><span data-stu-id="e52d8-213">A positive influence indicates the feature is contributing heavily towards the prediction.</span></span> <span data-ttu-id="e52d8-214">Эти значения не являются коэффициентами корреляции, поскольку это разные показатели.</span><span class="sxs-lookup"><span data-stu-id="e52d8-214">These values aren't correlation coefficients as they are different metrics.</span></span> <span data-ttu-id="e52d8-215">Дополнительные сведения см. в разделе[Важность признаков перестановки](https://docs.microsoft.com/azure/machine-learning/studio-module-reference/permutation-feature-importance).</span><span class="sxs-lookup"><span data-stu-id="e52d8-215">For more information, see [Permutation Feature Importance](https://docs.microsoft.com/azure/machine-learning/studio-module-reference/permutation-feature-importance).</span></span>

<span data-ttu-id="e52d8-216">Целиком [эксперимент с оттоком доступен в коллекции решений ИИ Azure](https://gallery.azure.ai/Experiment/Hotel-Churn-Predictive-Exp).</span><span class="sxs-lookup"><span data-stu-id="e52d8-216">The entire [churn experiment is available in the Azure AI Gallery](https://gallery.azure.ai/Experiment/Hotel-Churn-Predictive-Exp).</span></span>

## <a name="customer-lifetime-value-prediction"></a><span data-ttu-id="e52d8-217">Прогноз ценности клиентов в течение всего срока работы с ними</span><span class="sxs-lookup"><span data-stu-id="e52d8-217">Customer lifetime value prediction</span></span>

<span data-ttu-id="e52d8-218">Расчет ценности клиентов в течение всего срока работы с ними (CLTV) — один из ключевых показателей, который бизнес может использовать для оценки и сегментации своих клиентов.</span><span class="sxs-lookup"><span data-stu-id="e52d8-218">The customer lifetime value (CLTV) calculation is one of the key metrics that a business can use to assess and segment its customers.</span></span> <span data-ttu-id="e52d8-219">Для гостиничного бизнеса очень важно знать своих клиентов.</span><span class="sxs-lookup"><span data-stu-id="e52d8-219">For the hotel business, it’s critical to know their customers.</span></span> <span data-ttu-id="e52d8-220">Например, понимание факторов, составляющих хороших клиентов, является важной информацией.</span><span class="sxs-lookup"><span data-stu-id="e52d8-220">For example, understanding factors that make up good customers is crucial information.</span></span> <span data-ttu-id="e52d8-221">Это помогает руководству отеля оценить, на каких характеристиках им нужно сосредоточиться и улучшить их, чтобы удовлетворить своих клиентов, приносящих высокий доход.</span><span class="sxs-lookup"><span data-stu-id="e52d8-221">It helps the hotel management assess which features they need to focus on and improve to satisfy their high paying customers.</span></span> <span data-ttu-id="e52d8-222">Эти решения могут иметь прямое влияние на продажи и прибыль.</span><span class="sxs-lookup"><span data-stu-id="e52d8-222">These decisions can have a direct impact on sales and earnings.</span></span>  

### <a name="definition-of-cltv"></a><span data-ttu-id="e52d8-223">Определение CLTV</span><span class="sxs-lookup"><span data-stu-id="e52d8-223">Definition of CLTV</span></span>

<span data-ttu-id="e52d8-224">В этом примере мы определяем CLTV клиента как общую сумму в долларах, которую клиент, как ожидается, потратит в следующие 365 дней.</span><span class="sxs-lookup"><span data-stu-id="e52d8-224">For this example, we define the CLTV of a customer as the total dollar amount the customer is expected to spend in the next 365 days.</span></span> <span data-ttu-id="e52d8-225">Мы собираемся использовать данные за последние три года для всех клиентов, чтобы прогнозировать это значение.</span><span class="sxs-lookup"><span data-stu-id="e52d8-225">We are going to use the past three years’ worth of data for all customers to predict this value.</span></span>

### <a name="featurization"></a><span data-ttu-id="e52d8-226">Конструирование признаков</span><span class="sxs-lookup"><span data-stu-id="e52d8-226">Featurization</span></span>

<span data-ttu-id="e52d8-227">В этом случае конструирование признаков будет очень похоже на сценарий оттока.</span><span class="sxs-lookup"><span data-stu-id="e52d8-227">In this case, featurization is going to be quite like the churn scenario.</span></span> <span data-ttu-id="e52d8-228">Однако метки и прогнозируемые значения отличаются от указанных выше.</span><span class="sxs-lookup"><span data-stu-id="e52d8-228">However, the labels and predicted values are different than defined above.</span></span>

### <a name="model-selection"></a><span data-ttu-id="e52d8-229">Выбор модели</span><span class="sxs-lookup"><span data-stu-id="e52d8-229">Model selection</span></span>

<span data-ttu-id="e52d8-230">Прогнозирование CLTV представляет собой проблему регрессии, поскольку прогнозируемое значение является непрерывной переменной с положительным знаком.</span><span class="sxs-lookup"><span data-stu-id="e52d8-230">Predicting the CLTV is a regression problem as the predicted value is a positive valued continuous variable.</span></span> <span data-ttu-id="e52d8-231">На основании свойств признаков мы выбираем модель **Усиленная регрессия дерева решений** как один алгоритм и **Регрессия нейронной сети** как еще один алгоритм для обучения модели.</span><span class="sxs-lookup"><span data-stu-id="e52d8-231">Based on the feature properties, we select **Boosted Decision Tree Regression** as one algorithm and **Neural Network Regression** as another algorithm to train the model.</span></span>

## <a name="product-recommendation-or-next-best-action"></a><span data-ttu-id="e52d8-232">Рекомендация продуктов или оптимальное следующее действие</span><span class="sxs-lookup"><span data-stu-id="e52d8-232">Product recommendation or Next Best Action</span></span>

<span data-ttu-id="e52d8-233">Рекомендация продуктов в гостиничном сценарии интерпретируется как рекомендация услуг, предлагаемых отелем клиентам.</span><span class="sxs-lookup"><span data-stu-id="e52d8-233">Product recommendation in a hotel scenario is interpreted as recommending services offered by the hotel to the customers.</span></span> <span data-ttu-id="e52d8-234">Цель состоит в том, чтобы выбрать подходящие услуги для клиентов, чтобы их использование было максимальным.</span><span class="sxs-lookup"><span data-stu-id="e52d8-234">The objective is to choose the appropriate services for customers so that their usage is maximized.</span></span> <span data-ttu-id="e52d8-235">Это похоже на рекомендации фильмов для пользователей сервиса потокового видео.</span><span class="sxs-lookup"><span data-stu-id="e52d8-235">It’s similar to movie recommendations for video streaming service users.</span></span>

### <a name="definition-of-product-recommendation-or-next-best-action"></a><span data-ttu-id="e52d8-236">Определение рекомендации продуктов или оптимального следующего действия</span><span class="sxs-lookup"><span data-stu-id="e52d8-236">Definition of Product Recommendation or Next Best Action</span></span>

<span data-ttu-id="e52d8-237">Мы определяем цель как максимальное использование услуг в долларах за счет предложения наиболее подходящих услуг клиентам отеля в соответствии с их интересами.</span><span class="sxs-lookup"><span data-stu-id="e52d8-237">We define the goal as maximizing the dollar amount of service usage by offering the best matching services to hotel customers according to their interest.</span></span>

### <a name="featurization"></a><span data-ttu-id="e52d8-238">Конструирование признаков</span><span class="sxs-lookup"><span data-stu-id="e52d8-238">Featurization</span></span>

<span data-ttu-id="e52d8-239">Как и в модели оттока, мы объединяем ServiceCustomerID отеля с CustomerID, чтобы последовательно вырабатывать рекомендации для каждого CustomerID.</span><span class="sxs-lookup"><span data-stu-id="e52d8-239">Like the churn model, we are joining the hotel ServiceCustomerID with CustomerID in order to build recommendations consistently per CustomerID.</span></span>

![Конструирование признаков рекомендательной модели](media/azure-machine-learning-model-featurization.png)

<span data-ttu-id="e52d8-241">Данные берутся из трех разных сущностей, и на их основе извлекаются признаки.</span><span class="sxs-lookup"><span data-stu-id="e52d8-241">The data is sourced from three different entities and features are derived from them.</span></span> <span data-ttu-id="e52d8-242">Конструирование признаков для проблемы рекомендации отличается от сценариев оттока клиентов или CLTV.</span><span class="sxs-lookup"><span data-stu-id="e52d8-242">The featurization for the problem of recommendation is different compared to churn or CLTV scenarios.</span></span> <span data-ttu-id="e52d8-243">Модель рекомендаций требует входных данных в виде трех наборов признаков.</span><span class="sxs-lookup"><span data-stu-id="e52d8-243">The recommendation model needs input data in the form of three sets of features.</span></span>

### <a name="model-selection"></a><span data-ttu-id="e52d8-244">Выбор модели</span><span class="sxs-lookup"><span data-stu-id="e52d8-244">Model selection</span></span>

<span data-ttu-id="e52d8-245">Мы прогнозируем продукты или услуги, используя алгоритм, называемый **Обучение рекомендаций Matchbox**,чтобы обучить модель рекомендаций.</span><span class="sxs-lookup"><span data-stu-id="e52d8-245">We predict products or services by using the algorithm called **Train Matchbox Recommender** to train the recommendation model.</span></span>

![Алгоритм рекомендаций по продуктам](media/azure-machine-learning-model-recommendation-algorithm.png)

<span data-ttu-id="e52d8-247">Три входных порта для модели **Обучение рекомендаций Matchbox** принимают обучающие данные об использовании услуг, описание клиентов (необязательно) и описание услуги.</span><span class="sxs-lookup"><span data-stu-id="e52d8-247">The three input ports for the **Train Matchbox Recommender** model takes in the training service usage data, customer description (optional), and service description.</span></span> <span data-ttu-id="e52d8-248">Есть три разных способа оценки модели.</span><span class="sxs-lookup"><span data-stu-id="e52d8-248">There are three different ways of scoring the model.</span></span> <span data-ttu-id="e52d8-249">Один предназначен для оценки модели, где для ранжирования оцениваемых элементов рассчитывается оценка нормализованной дисконтированной совокупной прибыли (NDCG).</span><span class="sxs-lookup"><span data-stu-id="e52d8-249">One is for model evaluation where a Normalized Discounted Cumulative Gain (NDCG) score is calculated to rank the rated items.</span></span> <span data-ttu-id="e52d8-250">В этом эксперименте наша оценка NDCG составляет 0,97.</span><span class="sxs-lookup"><span data-stu-id="e52d8-250">In this experiment, we have the NDCG score as 0.97.</span></span> <span data-ttu-id="e52d8-251">Два других варианта — это оценка модели по всему каталогу рекомендуемых услуг или оценка только по элементам, которые пользователи не использовали ранее.</span><span class="sxs-lookup"><span data-stu-id="e52d8-251">The other two options are scoring the model on the entire recommendable service catalog, or scoring only on items that users have not used before.</span></span>

<span data-ttu-id="e52d8-252">Рассматривая дальше распределение рекомендаций по всему каталогу услуг, мы замечаем, что телефон, Wi-Fi и курьерская служба являются лучшими услугами, которые следует рекомендовать.</span><span class="sxs-lookup"><span data-stu-id="e52d8-252">Looking further on the distributions of the recommendations on the entire service catalog, we notice that phone, WiFi, and courier are the top services to be recommended.</span></span> <span data-ttu-id="e52d8-253">Это согласуется с тем, что мы обнаружили из распределений данных о потреблении услуг:</span><span class="sxs-lookup"><span data-stu-id="e52d8-253">This is consistent with what we found from the distributions of the service consumption data:</span></span>

![Выходные данные модели рекомендаций](media/azure-machine-learning-model-output.png)

<span data-ttu-id="e52d8-255">Целиком [эксперимент с рекомендациями по продукту доступен в коллекции решений ИИ Azure.](https://gallery.azure.ai/Experiment/Recommendation-4)</span><span class="sxs-lookup"><span data-stu-id="e52d8-255">The entire [product recommendation experiment can be accessed in Azure AI Gallery.](https://gallery.azure.ai/Experiment/Recommendation-4)</span></span>

## <a name="integrate-custom-models"></a><span data-ttu-id="e52d8-256">Интегрируйте собственные модели</span><span class="sxs-lookup"><span data-stu-id="e52d8-256">Integrate custom models</span></span>

<span data-ttu-id="e52d8-257">Чтобы использовать эти прогнозы в Customer Insights, вам необходимо **экспортировать** прогнозы вместе с идентификаторами клиентов.</span><span class="sxs-lookup"><span data-stu-id="e52d8-257">To use these predictions in Customer Insights, you need to **export** the predictions along with the customer IDs.</span></span> <span data-ttu-id="e52d8-258">[Экспортируйте их в то же хранилище BLOB-объектов Azure](https://docs.microsoft.com/azure/storage/common/storage-import-export-data-from-blobs), в которое вы экспортируете исходные данные.</span><span class="sxs-lookup"><span data-stu-id="e52d8-258">[Export them to the same Azure Blob storage location](https://docs.microsoft.com/azure/storage/common/storage-import-export-data-from-blobs) that you export the source data to.</span></span> <span data-ttu-id="e52d8-259">Прогностическую веб-службу можно запланировать для регулярного запуска и обновления оценок.</span><span class="sxs-lookup"><span data-stu-id="e52d8-259">The predictive web service can be scheduled to run regularly and update the scores.</span></span>

<span data-ttu-id="e52d8-260">Данные, созданные с помощью настраиваемой модели, можно использовать для дальнейшего обогащения данных о ваших клиентах.</span><span class="sxs-lookup"><span data-stu-id="e52d8-260">Data generated by the custom model can be used to further enrich your customer data.</span></span> <span data-ttu-id="e52d8-261">Дополнительные сведения см. в разделе [Пользовательские модели машинного обучения](custom-models.md).</span><span class="sxs-lookup"><span data-stu-id="e52d8-261">For more information, see [Custom machine learning models](custom-models.md).</span></span>
