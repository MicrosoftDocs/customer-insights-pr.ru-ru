---
title: Создание сложных сегментов с помощью конструктора сегментов
description: Используйте конструктор сегментов, чтобы создавать сложные сегменты клиентов, группируя их по различным атрибутам.
ms.date: 03/25/2022
ms.subservice: audience-insights
ms.topic: how-to
author: JimsonChalissery
ms.author: jimsonc
ms.reviewer: v-wendysmith
manager: shellyha
searchScope:
- ci-segments
- ci-segment-builder
- ci-segment-details
- customerInsights
ms.openlocfilehash: cde373cd65e296675e1b3c92f3024e1093853842
ms.sourcegitcommit: 8a28e9458b857adf8e90e25e43b9bc422ebbb2cd
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/18/2022
ms.locfileid: "9170651"
---
# <a name="create-complex-segments-with-segment-builder"></a>Создание сложных сегментов с помощью конструктора сегментов

Определите сложные фильтры вокруг единой сущности клиента и связанных с ней сущностей. Каждый сегмент после обработки создает набор записей о клиентах, которые можно экспортировать и выполнять действия с ними.

> [!TIP]
> Сегменты на основе **частных клиентов** автоматически включают доступную контактную информацию для участников сегмента. В средах для **организаций** сегменты основаны на организациях (компаниях или дочерних компаниях). Чтобы включить информацию контакта в сегмент, используйте функцию **Атрибуты проекта** в конструкторе сегментов. Убедитесь, что источники контактных данных [семантически сопоставлены с сущностью ContactProfile](semantic-mappings.md#define-a-contactprofile-semantic-entity-mapping).

## <a name="segment-builder"></a>Конструктор сегментов

На следующем рисунке показаны различные аспекты конструктора сегментов. Он показывает сегмент, который в результате дает группу клиентов. Клиенты заказывали товары в определенном интервале времени и набирали баллы поощрения или потратили определенную сумму денег.

:::image type="content" source="media/segment-builder-overview.png" alt-text="Элементы конструктора сегментов." lightbox="media/segment-builder-overview.png":::

1. Организуйте свой сегмент с помощью правил и подправил. Каждое правило или субправило состоит из условий. Комбинируйте условия с логическими операторами.

1. Выберите [путь отношений](relationships.md) между сущностями, который применяется к правилу. Путь отношения определяет, какие атрибуты могут использоваться в условии.

1. Управление правилами и субправилами. Измените положение правила или удалите его.

1. Добавьте условия и создайте правильный уровень вложенности с помощью подправил.

1. Применение операций задания к связанным правилам.

1. Используйте панель атрибутов, чтобы добавить доступные атрибуты сущности или создать условия на основе атрибутов. На панели отображается список сущностей и атрибутов, доступных для выбранного правила на основе выбранного пути отношения.

1. Добавьте условия на основе атрибутов к существующим правилам и субправилам или добавьте их в новое правило.

1. Отмена и повторение изменений при построении сегмента.

Приведенный выше пример иллюстрирует возможность сегментации. Мы определили сегмент для клиентов, которые купили в Интернете товаров не менее чем на 500 долларов США *и* проявляют интерес к разработке программного обеспечения.

## <a name="create-a-new-segment-with-segment-builder"></a>Создание нового сегмента с помощью конструктора сегментов

1. Перейдите **Сегменты**.

1. Выберите **Создать** > **Создать собственные**. На странице построителя сегментов вы определяете или составляете правила. Правило состоит из одного или нескольких условий, определяющих набор клиентов.

1. Выберите **Редактировать сведения** рядом с сегментом без названия. Укажите название для своего сегмента и обновите предложенное **Имя выходной сущности** для сегмента. При желании добавьте описание и [теги](work-with-tags-columns.md#manage-tags) к сегменту.

   :::image type="content" source="media/segments_edit_details.png" alt-text="Диалоговое окно изменения сведений.":::

1. В разделе **Rule1** выберите атрибут сущности, по которому вы хотите отфильтровать клиентов. Имеется два способа выбора атрибутов:
   - Просмотрите список доступных сущностей и атрибутов на панели **Добавить в правило** и выберите значок **+** рядом с атрибутом, который нужно добавить. Выберите, хотите ли вы добавить атрибут к существующему правилу или использовать его для создания нового правила.
   - Введите имя атрибута в разделе правил, чтобы увидеть подходящие предложения.

1. Выберите операторы, чтобы указать совпадающие значения условия. Атрибут может иметь в качестве значения один из четырех типов данных: числовой, строковый, дата или логический. В зависимости от типа данных атрибута для указания условия доступны разные операторы. Для сегментов с организациями доступны два специальных оператора для включения потенциальных иерархий между загруженными организациями. Используйте операторы *дочерняя* и *родительская* для включения связанных организаций.

1. Выберите **Добавить условие**, чтобы добавить в правило дополнительные условия. Чтобы создать правило под текущим правилом, выберите **Добавить пункт правила**.

1. Если в правиле используются другие сущности, отличные от сущности *Клиент*, выберите **Настройка пути связи**, чтобы сопоставить выбранную сущность с единой сущностью клиента. Если существует только один возможный путь связи, система выберет его автоматически. Различные [пути связи](relationships.md#relationship-paths) могут дать разные результаты. У каждого правила может быть свой собственный путь отношений.

   :::image type="content" source="media/relationship-path.png" alt-text="Потенциальный путь отношений при создании правила на основе сущности, сопоставленной с объединенной сущностью клиента.":::

1. Если у вас есть несколько условий в правиле, выберите, какой логический оператор их связывает.  
   - Оператор **И**: должны быть соблюдены все условия для включения записи в сегмент. Используйте эту опцию для определения условий для разных сущностей.
   - Оператор **ИЛИ**: должно быть соблюдено одно из условий для включения записи в сегмент. Используйте эту опцию для определения несколько условий для одной сущности.

   :::image type="content" source="media/segmentation-either-condition.png" alt-text="Правило с двумя условиями «И».":::

   При использовании оператора ИЛИ все условия должны основываться на сущностях, включенных в путь отношений.

1. Создайте несколько правил для создания разных наборов записей о клиентах. Объединяйте группы, чтобы включать клиентов, необходимых для вашего бизнеса. В частности, если вы не можете включить сущность в правило из-за указанного пути связи, вам необходимо создать новое правило, чтобы выбрать из нее атрибуты.

      :::image type="content" source="media/segment-rule-grouping.png" alt-text="Добавьте новое правило в сегмент и выберите оператор набора.":::

   1. Выберите **Добавить правило**.
   1. Выберите один из операторов набора: **Объединение**, **Пересечение** или **Исключение**.

      - **Объединение** объединяет две группы.
      - **Пересечение** перекрывает две группы. Только данные, которые *являются общими* в обеих группах, останутся в объединенной группе.
      - **За исключением** объединяет две группы. Только данные в группе А, которые *не являются общими* с данными в группе B, будут сохранены.

1. По умолчанию выходная сущность будет автоматически содержать все атрибуты профилей клиентов, которые соответствуют определенным фильтрам. Если сегмент основан на других сущностях, кроме сущности *Клиент*, выберите **Атрибуты проекта**, чтобы добавить атрибуты из этих сущностей в выходную сущность.

   > [!IMPORTANT]
   > Для сегментов, основанных на организациях, в сегмент необходимо включить сведения об одном или нескольких контактах каждой организации из сущности *ContactProfile*, чтобы этот сегмент можно было активировать или экспортировать в места назначения, требующие информации контакта. Для получения дополнительной информации о сущности *ContactProfile* см. в разделе [Семантические сопоставления](semantic-mappings.md).
   > Пример вывода для сегмента, основанного на корпоративных учетных записях с предполагаемыми атрибутами контактов, может выглядеть следующим образом:
   >
   > |ИД  |Имя учетной записи  |Выручка  |Имя контакта  | Роль контакта|
   > |---------|---------|---------|---------|---|
   > |10021     | Contoso | 100 тыс. | [Эбби Мосс, Рут Сото]  | [Генеральный директор, менеджер по закупкам]

   :::image type="content" source="media/segments-project-attributes.png" alt-text="Пример проецируемых атрибутов, выбранных на боковой панели для добавления к выходной сущности.":::
  
   Например: сегмент основан на сущности, содержащей данные о покупках, которые связаны с сущностью *Клиент*. Сегмент ищет всех клиентов из Испании, которые приобрели товары в текущем году. Вы можете добавить такие атрибуты, как цена товаров или дата покупки, ко всем совпадающим записям клиентов в выходной сущности. Эта информация может быть полезна для анализа сезонных корреляций общих расходов.

   > [!NOTE]
   > - **Атрибуты проекта** работают только для сущностей, которые имеют отношения «один ко многим» с сущностью клиента. Например, у одного клиента может быть несколько подписок.
   > - Если атрибут, который вы хотите проецировать, находится на расстоянии более одного прыжка от сущности *Клиент*, как определено отношением, этот атрибут должен использоваться в каждом правиле сегментного запроса, который вы создаете.
   > - Если атрибут, который вы хотите проецировать, находится на расстоянии ровно одного прыжка от сущности *Клиент*, этот атрибут не должен использоваться в каждом правиле сегментного запроса, который вы создаете.
   > - **Спроецированные атрибуты** учитываются при использовании операторов множества.

1. Нажмите **Выполнить**, чтобы создать сегмент. Выберите **Сохранить**, если вы хотите сохранить текущую конфигурацию и выполнить сегмент позже. Страница **Сегменты** отображается.

### <a name="segment-builder-tips"></a>Советы по конструктору сегментов

При создании сегмента с помощью конструктора сегментов помните о следующих советах:

- Конструктор сегментов не будет предлагать допустимые значения из сущностей при установке операторов для условий. Вы можете перейти в раздел **Данные** > **Сущности** и загрузить данные сущности, чтобы увидеть, какие значения доступны.
- Условия, основанные на датах, позволяют переключаться между фиксированными датами и плавающим диапазоном дат.
- Если у вас есть несколько правил для вашего сегмента, рядом с правилом, которое вы редактируете, будет синяя вертикальная линия.
- Вы можете перемещать правила и условия в другие места в определении сегмента. Выберите вертикальное многоточие (&vellip;) рядом с правилом или условием, а затем укажите, как и куда его переместить.
- Элементы управления **Отменить** и **Повторить** на панели команд позволяют откатывать изменения.
- После создания сегмента в некоторых сегментах можно [отслеживать использование сегмента](segments.md#track-usage-of-a-segment).

## <a name="next-steps"></a>Следующие шаги

[Экспортируйте сегмент](export-destinations.md) и исследуйте [интеграцию карточки клиента](customer-card-add-in.md), чтобы использовать сегменты в других приложениях.

[!INCLUDE [footer-include](includes/footer-banner.md)]
