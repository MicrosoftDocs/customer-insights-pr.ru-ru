---
title: Соответствие сущностей для унификации данных
description: Найдите совпадения сущностей для создания унифицированных профилей клиентов.
recommendations: false
ms.date: 05/05/2022
ms.subservice: audience-insights
ms.topic: tutorial
author: v-wendysmith
ms.author: mukeshpo
ms.reviewer: v-wendysmith
manager: shellyha
searchScope:
- ci-match
- ci-merge
- ci-map
- customerInsights
ms.openlocfilehash: bc470dd932c2c981adc5840bb52d60f8dfe0de61
ms.sourcegitcommit: 6a5f4312a2bb808c40830863f26620daf65b921d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/11/2022
ms.locfileid: "8740965"
---
# <a name="match-conditions"></a>Условия сопоставления

[!INCLUDE [m3-prod-trial-note](includes/m3-prod-trial-note.md)]

Этот шаг объединения определяет порядок сопоставления и правила сопоставления сущностей. Для этого шага требуется как минимум две сущности.

> [!NOTE]
> После того, как вы создадите условия сопоставления и нажмете **Далее**, вы не сможете удалить выбранную сущность или атрибут. При необходимости нажмите **Назад** для просмотра выбранных сущностей и атрибутов, прежде чем продолжить.

## <a name="include-enriched-entities-preview"></a>Включение обогащенных сущностей (предварительная версия)

Если вы обогатили сущности на уровне источника данных, выберите их, чтобы улучшить результаты объединения. Дополнительная информация дана в теме [Обогащение источников данных](data-sources-enrichment.md). Если вы выбрали обогащенные сущности на странице **Повторяющиеся записи**, вам не нужно выбирать их снова.

1. На странице **Условия сопоставления** нажмите **Использовать расширенные сущности** в верхней части страницы.

1. В области **Использовать обогащенные сущности** выберите одну или несколько обогащенных сущностей.

1. Нажмите кнопку **Готово**.

## <a name="specify-the-match-order"></a>Задание порядка установления соответствия

Каждое сопоставление объединяет две или более сущности в одну консолидированную сущность. В то же время в нем хранятся уникальные записи клиентов. Порядок сопоставления указывает порядок, в котором система пытается сопоставить записи.

> [!IMPORTANT]
> Первая сущность в списке называется основной сущностью. Основная сущность является основой для вашего набора данных единых профилей. К этой сущности будут добавлены дополнительные выбранные сущности.
>
> Важные замечания:
>
> - Выберите сущность с наиболее полными и надежными данными профиля о ваших клиентах в качестве основной сущности.
> - Выберите сущность, которая имеет несколько атрибутов, общих с другими сущностями (например, имя, номер телефона или адрес электронной почты), в качестве основной сущности.

1. На станице **Условия сопоставления** используйте стрелки вверх и вниз для перемещения сущностей в нужном порядке или перетащите их. Например, выберите **Contacts:eCommerce** как основную сущность и **CustomerLoyalty:Loyalty** в качестве второй сущности.

1. Чтобы каждая запись в сущности была уникальным клиентом, независимо от того, будет ли найдено совпадение , выберите **Включить все**. Любые записи в этой сущности, которые не совпадают с записями в других сущностях, включаются в единый профиль. Записи, не имеющие совпадений, называются отдельными.
  
Основная сущность *Contacts:eCommerce* сопоставляется со следующей сущностью *CustomerLoyalty:Loyalty*. Набор данных, полученный в результате первого шага сопоставления, сопоставляется со следующей сущностью, если у вас более двух сущностей.

:::image type="content" source="media/m3_match.png" alt-text="Снимок экрана с выбранным порядком сопоставления для сущностей." lightbox="media/m3_match.png":::

## <a name="define-rules-for-match-pairs"></a>Определите правила сопоставления

Правила соответствия определяют логику, по которой будет производиться поиск соответствий в определенной паре сущностей. Правило состоит из одного или нескольких условий.

Предупреждение рядом с именем сущности означает, что для пары совпадения не определено правило сопоставления.

1. Нажмите **Добавить правило** для пары сущностей, чтобы определить правила сопоставления.

1. В области **Добавить правило** настройте условия для правила.

   :::image type="content" source="media/m3_add_rule.png" alt-text="Снимок экрана области добавления правила.":::

   - **Нажмите "Сущность/поле" (первая строка)**: выберите связанную сущность и атрибут, чтобы указать свойство записи, которое, вероятно, является уникальным для клиента. Например, номер телефона или адрес электронной почты. Избегайте сопоставления по атрибутам типа действия. Например, ИД покупки, скорее всего, не найдет соответствия в других типах записей.

   - **Нажмите "Сущность/поле" (вторая строка)**: выберите атрибут, который относится к атрибуту сущности, указанной в первой строке.

   - **Нормализация**: выберите из следующих вариантов нормализации для выбранных атрибутов.
     - **Числительные**: преобразует другие числовые системы, например римские цифры, в арабские. *VIII* становится *8*.
     - **Символы**: удаляет все символы и специальные знаки. *Head&Shoulder* становится *HeadShoulder*.
     - **Текст в нижний регистр**: переводит все символы в нижний регистр. *ВСЕ ЗАГЛАВНЫЕ БУКВЫ и Капитализация Начальных Букв* становится *все заглавные буквы и капитализация начальных Букв*.
     - **Тип (телефон, имя, адрес, организация)**: стандартизирует имена, должности, номера телефонов, адреса и организации.
     - **Unicode в ASCII**: преобразует обозначение Unicode в символы ASCII. */u00B2* становится *2*.
     - **Пробел**: удаляет все пробелы. *Hello   World* становится *HelloWorld*.

   - **Точность**: установите уровень точности, чтобы иметь доступ к этому условию.
     - **Базовый**: выберите *Низкий (30%)*, *Средний (60%)*, *Высокий (80%)*, и *Точный (100%)*. Выберите **Точно**, чтобы сопоставлять только записи, которые совпадают на 100 процентов.
     - **Пользовательский**: задайте процент, которому должны соответствовать записи. Система будет сопоставлять только записи, превышающие этот порог.

   - **Имя**: имя для правила.

1. Чтобы сопоставлять сущности, только если атрибуты соответствуют нескольким условиям, нажмите **Добавить** > **Добавить условие**, чтобы добавить дополнительные условия к правилу сопоставления. Условия связаны с помощью логического оператора "И", поэтому выполнение происходит только при соблюдении всех условий.

1. При желании рассмотрите дополнительные параметры, такие как [исключения](#add-exceptions-to-a-rule) или [пользовательские условия сопоставления](#specify-custom-match-conditions).

1. Выберите **Готово**, чтобы сохранить правило.

1. Вы также можете (необязательно) [добавить дополнительные правила](#add-rules-to-a-match-pair).

1. Нажмите кнопку **Далее**.

> [!div class="nextstepaction"]
> [Следующий шаг: объединение полей](merge-entities.md)

### <a name="add-rules-to-a-match-pair"></a>Добавление правила в сопоставляемую пару

Правила соответствия представляют собой наборы условий. Чтобы сопоставлять сущности по условиям на основе нескольких атрибутов, добавляйте дополнительные правила.

1. Нажмите **Добавить правило** для сущности, к которой нужно добавить правила.

1. Следуйте инструкциям в разделе [Определение правил для сопоставляемых пар](#define-rules-for-match-pairs).

> [!NOTE]
> Порядок правил имеет значение. Алгоритм сопоставления пытается сопоставить данную запись клиента на основе вашего первого правила и переходит ко второму правилу только в том случае, если с первым правилом не было найдено совпадений.

## <a name="advanced-options"></a>Дополнительные параметры

### <a name="add-exceptions-to-a-rule"></a>Добавить исключения в правило

В большинстве случаев сопоставление сущностей приводит к уникальным профилям клиентов с консолидированными данными. Чтобы динамически реагировать на редкие случаи ложных положительных и ложных отрицательных результатов, вы можете определить исключения для правила соответствия. Исключения применяются после обработки правил сопоставления и избегают сопоставления всех записей, удовлетворяющих критериям исключения.

Например, если ваше правило сопоставления объединяет фамилия, город и дату рождения, система будет идентифицировать близнецов с одинаковым фамилиями, которые живут в одном городе в одном профиле. Вы можете указать исключение, которое не соответствует профилям, если имя в объединяемых сущностях не совпадает.

1. В области **Изменить правило** выберите **Добавить** > **Добавить исключение**.

1. Укажите критерии исключения.

1. Выберите **Готово**, чтобы сохранить правило.

### <a name="specify-custom-match-conditions"></a>Укажите пользовательские условия сопоставления

Вы можете указать условия, которые переопределяют логику сопоставления по умолчанию. Возможны четыре варианта:

|Вариант  |Description |Пример  |
|---------|---------|---------|
|Всегда соответствуют     | Определяет значения, которые всегда совпадают.         |  Всегда совпадают *Mike* и *MikeR*.       |
|Никогда не соответствуют     | Определяет значения, которые никогда не совпадают.        | Никогда не совпадают *John* и *Jonathan*.        |
|Пользовательский пропуск     | Определяет значения, которые система всегда должна игнорировать на этапе сопоставления. |  Игнорирует значения *11111* и *Unknown* во время сопоставления.        |
|Сопоставление псевдонима    | Определение значений, которые система должна рассматривать как одно и то же значение.         | Рассмотрение *Joe* как равное *Joseph*.        |

1. Выберите **Пользовательский**.

   :::image type="content" source="media/m3_match_custom.png" alt-text="Пользовательская кнопка":::

1. Выберите **Пользовательский тип** и нажмите **Скачать шаблон**. Для каждого варианта совпадения нужен отдельный шаблон.

1. Откройте загруженный файл шаблона и заполните данные. Шаблон содержит поля для указания значений сущности и первичного ключа сущности, которые будут использоваться в пользовательском соответствии. Например, если вам нужно, чтобы первичный ключ *12345* из сущности *Продажи*, всегда соответствовал первичному ключу *34567* из сущности *Контакт*, заполните шаблон:
    - Entity1: Продажи
    - Entity1Key: 12345
    - Entity2: Контакт
    - Entity2Key: 34567

   В одном файле шаблона можно указывать пользовательские записи совпадений из нескольких сущностей.

   Если вы хотите указать настраиваемое соответствие для дедупликации в сущности, укажите ту же сущность, что и Entity1 и Entity2, и установите разные значения первичного ключа.

1. После добавления всех переопределений сохраните файл шаблона.

1. Перейдите **Данные** > **Источники данных** и примите файлы шаблонов как новые сущности.

1. После отправки файлов выберите снова значение **Пользовательский**. Выберите необходимые объекты из раскрывающегося меню и выберите **Готово**.

   :::image type="content" source="media/custom-match-overrides.png" alt-text="Снимок экрана диалогового окна для выбора переопределений для пользовательского сценария сопоставления.":::

1. Применение настраиваемого сопоставления зависит от варианта сопоставления, который вы хотите использовать.

   - Для **Всегда совпадает** или **Никогда не совпадает** переходите к следующему шагу.
   - Для параметров **Пропуск** или **Сопоставление псевдонима** выберите значение **Изменить** в существующем правиле соответствия или создайте новое правило. В раскрывающемся списке Нормализация выберите **Пользовательский пропуск** или **Сопоставление псевдонима** и выберите **Готово**.

1. Нажмите **Готово** в области **Пользовательский**, чтобы применить пользовательскую конфигурацию сопоставления.

> [!div class="nextstepaction"]
> [Следующий шаг: объединение полей](merge-entities.md)

[!INCLUDE [footer-include](includes/footer-banner.md)]
